"use strict";(globalThis["webpackChunkfast_front"]=globalThis["webpackChunkfast_front"]||[]).push([[118],{917:(e,a,t)=>{t.d(a,{Ht:()=>c,TI:()=>i,p6:()=>r,uD:()=>l});var o=t(1569);const n="/whitesite";async function l(e=0,a=10){return(0,o.api)({url:n+"/list",method:"get",params:{page:e,pageSize:a}})}async function r({name:e,home:a,comment:t,importHost:l}){return(0,o.api)({url:n,method:"post",data:{name:e,home:a,comment:t,importHost:l}})}async function c(e){return(0,o.api)({url:n,method:"delete",data:{ids:e}})}async function i(e){return(0,o.api)({url:n,method:"put",data:e})}},9118:(e,a,t)=>{t.r(a),t.d(a,{default:()=>ne});var o=t(9835),n=t(6970);const l=e=>((0,o.dD)("data-v-18082107"),e=e(),(0,o.Cn)(),e),r=l((()=>(0,o._)("div",{class:"text-h6"},"节点",-1))),c={style:{width:"100%"}},i={class:"text-subtitle1 text-white text-weight-bold"};function d(e,a,t,l,d,s){const u=(0,o.up)("q-card-section"),m=(0,o.up)("q-checkbox"),p=(0,o.up)("q-th"),g=(0,o.up)("q-tr"),f=(0,o.up)("update-import-host"),w=(0,o.up)("q-td"),b=(0,o.up)("edit-white"),v=(0,o.up)("q-table"),Z=(0,o.up)("q-card"),h=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(h,{class:"column"},{default:(0,o.w5)((()=>[(0,o.Wm)(Z,{class:"list-card",square:"",flat:""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"bg-secondary text-white"},{default:(0,o.w5)((()=>[r])),_:1}),(0,o._)("div",c,[(0,o.Wm)(v,{rows:e.rows,loading:e.loading,columns:e.columns,selection:"multiple",selected:e.selected,"onUpdate:selected":a[0]||(a[0]=a=>e.selected=a),"row-key":"name",flat:"",pagination:e.pageConfig,"onUpdate:pagination":a[1]||(a[1]=a=>e.pageConfig=a),onRequest:e.newPagination,square:""},{header:(0,o.w5)((e=>[(0,o.Wm)(g,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"bg-secondary"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:e.selected,"onUpdate:modelValue":a=>e.selected=a,color:"accent","keep-color":"",class:"text-black"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(a=>((0,o.wg)(),(0,o.j4)(p,{key:a.name,props:e,class:"bg-secondary"},{default:(0,o.w5)((()=>[(0,o._)("div",i,(0,n.zw)(a.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),"body-cell-importHost":(0,o.w5)((a=>[(0,o.Wm)(w,{props:a},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{data:a,afterFunc:e.afterSubmit,loading:e.loading},null,8,["data","afterFunc","loading"])])),_:2},1032,["props"])])),"body-cell-operation":(0,o.w5)((a=>[(0,o.Wm)(w,{props:a},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{data:a,afterFunc:e.afterSubmit,loading:e.loading},null,8,["data","afterFunc","loading"])])),_:2},1032,["props"])])),_:1},8,["rows","loading","columns","selected","pagination","onRequest"])])])),_:1})])),_:1})}var s=t(9302),u=t(4376),m=t(499);var p=t(917);const g=(0,o.aZ)({name:"createCard",props:{afterSubmit:{type:Function,default:()=>{}}},setup(e){const a=(0,m.iH)(!1),t=(0,s.Z)(),o=(0,m.iH)({name:"",home:"",comment:"",importHost:[]});const n=(0,m.iH)("");function l(){o.value.importHost=n.value.split("\n"),(0,p.p6)(o.value).then((o=>{t.notify({type:"positive",message:"添加成功"}),e.afterSubmit(),a.value=!1})).catch((e=>{t.notify({type:"negative",message:e.response.data.message})}))}return{data:o,onSubmit:l,card:a,text:n}}});var f=t(1639),w=t(4455),b=t(2074),v=t(4458),Z=t(3190),h=t(8326),y=t(6611),Q=t(2857),W=t(926),_=t(9984),q=t.n(_);q()(g,"components",{QBtn:w.Z,QDialog:b.Z,QCard:v.Z,QCardSection:Z.Z,QForm:h.Z,QInput:y.Z,QIcon:Q.Z,QSeparator:W.Z});t(9665);const D=(0,o.aZ)({name:"deleteCofirmTable",props:{columns:Array,rows:Array,loading:Boolean,afterDelete:{type:Function,default:()=>{}}},setup(e){const a=(0,m.iH)(!1),t=(0,s.Z)();async function o(){const o=[];e.rows.forEach((e=>{o.push(e.id)})),await(0,p.Ht)(o),t.notify({type:"positive",message:"删除成功！"}),a.value=!1,e.afterDelete()}return{layout:a,onDelete:o}}});var H=t(7799),V=t(3532),C=t(1682);q()(D,"components",{QBtn:w.Z,QDialog:b.Z,QCard:v.Z,QCardSection:Z.Z,QIcon:Q.Z,QTable:H.Z,QTr:V.Z,QTh:C.Z,QSeparator:W.Z});const S={key:0},k={key:0},x={class:"row no-wrap text-h6 items-center"},U=(0,o._)("div",{class:"col ellipsis"}," 修改匹配的URL ",-1),T={class:"q-pa-md"},F={class:"column"};function I(e,a,t,n,l,r){const c=(0,o.up)("q-badge"),i=(0,o.up)("q-icon"),d=(0,o.up)("q-card-section"),s=(0,o.up)("q-input"),u=(0,o.up)("q-separator"),m=(0,o.up)("q-btn"),p=(0,o.up)("q-card"),g=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)("div",{class:"column full-height full-width",onClick:a[3]||(a[3]=a=>e.layout=!1)},[e.data.value?((0,o.wg)(),(0,o.iD)("div",S,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.data.value.slice(0,3),(e=>((0,o.wg)(),(0,o.iD)("div",{key:e},[(0,o.Wm)(c,{color:"accent",label:e},null,8,["label"])])))),128)),e.data.value.length>3?((0,o.wg)(),(0,o.iD)("div",k,[(0,o.Wm)(c,{color:"accent",label:"..."})])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),(0,o.Wm)(g,{modelValue:e.layout,"onUpdate:modelValue":a[2]||(a[2]=a=>e.layout=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"create-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"bg-secondary text-accent"},{default:(0,o.w5)((()=>[(0,o._)("div",x,[(0,o.Wm)(i,{name:"warning"}),U])])),_:1}),(0,o._)("div",T,[(0,o.Wm)(s,{hint:"每条记录一行",modelValue:e.text,"onUpdate:modelValue":a[0]||(a[0]=a=>e.text=a),filled:"",autogrow:""},null,8,["modelValue"])]),(0,o.Wm)(u),(0,o.Wm)(d,{class:""},{default:(0,o.w5)((()=>[(0,o._)("div",F,[(0,o.Wm)(m,{label:"更新",color:"accent",unelevated:"",onClick:a[1]||(a[1]=a=>e.onUpdate(e.data.row))})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}const P=(0,o.aZ)({name:"updateImportHost",props:{data:Object,loading:Boolean,afterFunc:{type:Function,default:()=>{}}},setup(e){const a=(0,m.iH)(!1),t=(0,s.Z)();function o(e){return e?e.join("\n"):""}const n=(0,m.iH)(o(e.data.value));async function l(o){o.importHost=n.value.split("\n"),await(0,p.TI)(o).catch((e=>(t.notify({type:"negative",message:"更新失败"}),Promise.reject(error)))),t.notify({type:"positive",message:"更新成功"}),a.value=!1,e.afterFunc()}return{layout:a,onUpdate:l,text:n}}});var j=t(990);const z=(0,f.Z)(P,[["render",I]]),B=z;q()(P,"components",{QBadge:j.Z,QDialog:b.Z,QCard:v.Z,QCardSection:Z.Z,QIcon:Q.Z,QInput:y.Z,QSeparator:W.Z,QBtn:w.Z,QTable:H.Z});const Y={class:"text-left q-gutter-md"},A=(0,o._)("div",{class:"row no-wrap items-center"},[(0,o._)("div",{class:"col text-h6 ellipsis"}," 编辑 ")],-1),R={class:"column"};function L(e,a,t,n,l,r){const c=(0,o.up)("q-toggle"),i=(0,o.up)("q-card-section"),d=(0,o.up)("q-icon"),s=(0,o.up)("q-input"),u=(0,o.up)("q-btn"),m=(0,o.up)("q-form"),p=(0,o.up)("q-separator"),g=(0,o.up)("q-card"),f=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)("div",Y,[(0,o.Wm)(c,{color:"accent",modelValue:e.newData.enable,"onUpdate:modelValue":[a[0]||(a[0]=a=>e.newData.enable=a),a[1]||(a[1]=a=>e.onSubmit(e.newData))],dense:""},null,8,["modelValue"]),(0,o.Wm)(u,{icon:"edit",unelevated:"",round:"",size:"sm",color:"accent",onClick:a[8]||(a[8]=a=>e.card=!0)},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{modelValue:e.card,"onUpdate:modelValue":a[7]||(a[7]=a=>e.card=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"create-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{class:"bg-secondary text-white"},{default:(0,o.w5)((()=>[A])),_:1}),(0,o.Wm)(i,{class:""},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{onSubmit:a[6]||(a[6]=a=>e.onSubmit(e.newData)),class:"q-gutter-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{filled:"",modelValue:e.newData.name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.newData.name=a),color:"accent",disable:"",hint:"不可更改","label-color":"accent",label:"站点名称","lazy-rules":"",rules:[e=>e&&e.length>0||"至少要写点什么吧"]},{prepend:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"public",color:"accent"})])),_:1},8,["modelValue","rules"]),(0,o.Wm)(s,{filled:"",modelValue:e.newData.home,"onUpdate:modelValue":a[3]||(a[3]=a=>e.newData.home=a),hint:"站点主页的地址，为了安全，只支持https协议",label:"主页",color:"accent","label-color":"accent","lazy-rules":"",rules:[e=>e&&e.length>0||"至少要写点什么吧"]},{prepend:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"link",color:"accent"})])),_:1},8,["modelValue","rules"]),(0,o.Wm)(s,{filled:"",modelValue:e.newData.comment,"onUpdate:modelValue":a[4]||(a[4]=a=>e.newData.comment=a),label:"介绍",color:"accent","label-color":"accent","lazy-rules":""},{prepend:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"comment",color:"accent"})])),_:1},8,["modelValue"]),(0,o.Wm)(s,{hint:"每条记录一行",label:"匹配URL",modelValue:e.text,"onUpdate:modelValue":a[5]||(a[5]=a=>e.text=a),filled:"",color:"accent","label-color":"accent",autogrow:""},{prepend:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"add_link",color:"accent"})])),_:1},8,["modelValue"]),(0,o._)("div",R,[(0,o.Wm)(u,{label:"确认",type:"submit",unelevated:"",color:"accent"})])])),_:1})])),_:1}),(0,o.Wm)(p)])),_:1})])),_:1},8,["modelValue"])])),_:1})])}const E=(0,o.aZ)({name:"editWhite",props:{data:Object,loading:Boolean,afterFunc:{type:Function,default:()=>{}}},setup(e){const a=(0,m.iH)(!1),t=(0,s.Z)(),o=(0,m.iH)({id:e.data.row.id,name:e.data.row.name,home:e.data.row.home,comment:e.data.row.comment,enable:e.data.row.enable});function n(e){return e?e.join("\n"):""}const l=(0,m.iH)(n(e.data.row.importHost));async function r(o){o.importHost=l.value.split("\n"),await(0,p.TI)(o).catch((e=>(t.notify({type:"negative",message:"更新失败"}),Promise.reject(error)))),t.notify({type:"positive",message:"更新成功"}),a.value=!1,e.afterFunc()}return{newData:o,onSubmit:r,card:a,text:l}}});var K=t(3175);const M=(0,f.Z)(E,[["render",L]]),N=M;q()(E,"components",{QToggle:K.Z,QBtn:w.Z,QDialog:b.Z,QCard:v.Z,QCardSection:Z.Z,QForm:h.Z,QInput:y.Z,QIcon:Q.Z,QSeparator:W.Z});var O=t(1569);const $="/node";async function G(e=0,a=10){return(0,O.api)({url:$,method:"get",params:{page:e,pageSize:a}})}const J=[{name:"id",required:!0,label:"ID",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!1},{name:"region",align:"left",label:"区域",field:"region",sortable:!1},{name:"address",align:"left",label:"地址",field:"address",sortable:!1},{name:"updatedAt",align:"left",label:"上报时间",field:"updatedAt",format:e=>u.ZP.formatDate(new Date(1e3*e),"YYYY-MM-DD HH:mm:ss"),sortable:!1}],X=(0,o.aZ)({name:"WhiteList",setup(){const e=(0,m.iH)({page:1,rowsPerPage:10,rowsNumber:0}),a=(0,m.iH)([]),t=(0,m.iH)(!1),n=(0,m.iH)([]),l=((0,s.Z)(),o=>{t.value=!0,G(o.pagination.page-1,o.pagination.rowsPerPage).then((t=>{a.value=t.data.list,e.value={page:t.data.page+1,rowsPerPage:t.data.pageSize,rowsNumber:t.data.count},n.value=[]})).finally((()=>{t.value=!1}))});function r(){l({pagination:e.value})}return(0,o.bv)((()=>{r()})),{columns:J,selected:n,rows:a,pageConfig:e,newPagination:l,loading:t,afterSubmit:r}},components:{updateImportHost:B,EditWhite:N}});var ee=t(9885),ae=t(1221),te=t(7220);const oe=(0,f.Z)(X,[["render",d],["__scopeId","data-v-18082107"]]),ne=oe;q()(X,"components",{QPage:ee.Z,QCard:v.Z,QCardSection:Z.Z,QTable:H.Z,QTr:V.Z,QTh:C.Z,QCheckbox:ae.Z,QTd:te.Z})}}]);